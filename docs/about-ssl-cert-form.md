# Формат SSL сертификата

[Источник](https://www.emaro-ssl.ru/blog/convert-ssl-certificate-formats/); ниже адаптированный конспект.

## Формат SSL сертификата: как конвертировать сертификат в .pem, .cer, .crt, .der, pkcs или pfx?

Для успешной установки и функционирования SSL сертификатов на различных платформах и устройствах, нередко их необходимо предоставить в разных форматах. Например, серверы Windows используют PFX файлы, для Apache серверов необходимы PEM файлы с расширением .crt или .cer. В этой статье мы поможем вам разобраться в следующих вопросах:

   - Какие бывают форматы SSL сертификатов?
   - Чем они отличаются?
   - Как конвертировать SSL сертификаты из одного формата в другой?

## Обзор форматов сертификатов SSL
### Формат сертификата PEM

`PEM` – наиболее популярный формат среди сертификационных центров. `PEM` сертификаты могут иметь расширение `.pem`, `.crt`, `.cer`, и `.key` (файл приватного ключа). Она представляют собой `ASCII` файлы, закодированные по схеме `Base64`. Когда вы открываете файл `pem` формата в текстовом редакторе, вы можете увидеть, что текст кода в нем начинается с тега `-----BEGIN CERTIFICATE-----` и заканчивая тегом `-----END CERTIFICATE-----`.

`Apache`/`Nginx` и другие подобные серверы используют сертификаты в `PEM` формате. Обратите внимание, что в одном файле может содержатся несколько `SSL сертификатов` и даже `приватный ключ`, один под другим. В таком случае каждый сертификат отделен от остальных ранее указанными тегами `BEGIN` и `END`. Как правило, для установки `SSL сертификата` на `Apache`/`Nginx`, сертификаты и приватный ключ должны быть в разных файлах.

### Формат сертификата DER

`DER` формат – это бинарный тип сертификата вместо формата `PEM`. В `PEM` формате чаще всего используется расширение файла `.cer`, но иногда можно встретить и расширение файла `.der`. Поэтому чтобы отличить `SSL сертификат` в формате `PEM` от формата `DER`, следует открыть его в текстовом редакторе и найти теги начала и окончания сертификата (`BEGIN`/`END`). `DER` `SSL сертификаты`, как правило, используются на платформах `Java`. Используется в `esp8266/Arduino` `WiFiClientSecure`

### PKCS # 7 / P7B сертификат

`SSL` сертификаты в формате `PKCS # 7` или `P7B` — это файлы, которые хранятся в формате `Base64` `ASCII` и имеют расширение файла `.p7b` или `.p7c`. `P7B` сертификаты содержат теги начала сертификата `—— BEGIN PKCS7 ——` и его конца `—— END PKCS7 ——`. Файлы в формате `P7B` включают в себя только ваш `SSL сертификат` и промежуточные `SSL сертификаты`. `Приватный ключ` при этом идет отдельным файлом. `SSL` сертификаты в формате `PKCS # 7` / `P7B` поддерживают следующие платформы: `Microsoft Windows` и `Java Tomcat`.
### PFX сертификат (формат PKCS # 12)

Формат `SSL сертификата` `PKCS # 12` или, как его еще называют, `PFX сертификат` — бинарный формат, при использовании которого в одном зашифрованном файле хранится не только ваш личный `сертификат сервера` и `промежуточные сертификаты` центра сертификации, но и ваш `закрытый ключ`. `PFX` файлы, как правило, имеют расширение `.pfx` или `.p12`. Обычно, файлы формата `PFX` используются на `Windows серверах` для импорта и экспорта файлов `SSL сертификатов` и вашего `приватного ключа`.

## Конвертация SSL сертификатов в OpenSSL

Данные `команды OpenSSL` дают возможность преобразовать `сертификаты` и `ключи` в разные форматы. Для того чтобы сделать их совместимыми с определенными видами серверов, либо ПО. К примеру, Вам необходимо конвертировать обыкновенный файл `PEM`, который будет работать с `Apache`/`Nginx`, в формат `PFX` (`PKCS # 12`) с целью применения его с `Tomcat`, либо `IIS`.

    Конвертировать PEM в DER

        openssl x509 -outform der -in certificate.pem -out certificate.der

    Конвертировать PEM в P7B

        openssl crl2pkcs7 -nocrl -certfile certificate.cer -out certificate.p7b -certfile CACert.cer

    Конвертировать PEM в PFX

        openssl pkcs12 -export -out certificate.pfx -inkey privateKey.key -in certificate.crt -certfile CACert.crt

    Конвертировать DER в PEM

        openssl x509 -inform der -in certificate.cer -out certificate.pem

    Конвертировать P7B в PEM

        openssl pkcs7 -print_certs -in certificate.p7b -out certificate.cer

    Конвертировать P7B в PFX

        openssl pkcs7 -print_certs -in certificate.p7b -out certificate.ceropenssl pkcs12 -export -in certificate.cer -inkey privateKey.key -out certificate.pfx -certfile CACert.cer

    Конвертировать PFX в PEM

        openssl pkcs12 -in certificate.pfx -out certificate.cer -nodes

